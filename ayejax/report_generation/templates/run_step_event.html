{% if event.step %}
<div class="details">
  <strong>Step Type: {{ event.step | title | replace('-', ' ') }}</strong>

  {% if event.context %}
  <div class="screenshot">
    <img
      src="data:image/png;base64,{{ event.context }}"
      alt="Screenshot context"
      style="max-width: 400px"
    />
  </div>
  {% endif %} {% if event.step == 'text-processing' %}
  <p>Processing text sections from the page to find matching API responses.</p>
  {% elif event.step == 'close-overlay-popup' %}
  <p>Attempting to close overlay popup that might be blocking content.</p>
  {% elif event.step == 'load-more-content' %}
  <p>Clicking button to load more content on the page.</p>
  {% elif event.step == 'skip-to-content' %}
  <p>Clicking link to skip to main content area.</p>
  {% elif event.step == 'scroll-to-next-view' %}
  <p>Scrolling to the next view to find more content.</p>
  {% endif %}
</div>
{% elif event.action == 'llm-completion' %}
<div class="details">
  <strong>LLM Analysis</strong>
  <div class="details-grid">
    <div class="details-item"><strong>Status:</strong> {{ event.status }}</div>
    {% if event.status == 'success' %}
    <div class="details-item">
      <strong>Input Tokens:</strong> {{ event.input_tokens }}
    </div>
    <div class="details-item">
      <strong>Output Tokens:</strong> {{ event.output_tokens }}
    </div>
    <div class="details-item">
      <strong>Cost:</strong> ${{ "%.4f" | format(event.cost) }}
    </div>
    {% endif %} {% if event.exception %}
    <div class="details-item">
      <strong>Exception:</strong> {{ event.exception }}
    </div>
    {% endif %}
  </div>
  {% if event.result %}
  <div class="expandable collapsed">Analysis Result</div>
  <div class="collapsible">
    <div class="json-view">{{ event.result | tojson(indent=2) }}</div>
  </div>
  {% endif %}
</div>
{% elif event.action == 'matching' %}
<div class="details">
  <strong>Content Matching</strong>
  <div class="details-grid">
    <div class="details-item"><strong>URL:</strong> {{ event.url }}</div>
    {% if event.score %}
    <div class="details-item">
      <strong>Match Score:</strong> {{ "%.2f" | format(event.score) }}
    </div>
    {% endif %}
    <div class="details-item"><strong>Status:</strong> {{ event.status }}</div>
  </div>
</div>
{% elif event.action == 'similar-content-skip' %}
<div class="details">
  <strong>Similar Content Skip</strong>
  <div class="details-grid">
    <div class="details-item"><strong>Status:</strong> {{ event.status }}</div>
    {% if event.target %}
    <div class="details-item"><strong>Target:</strong> {{ event.target }}</div>
    {% endif %}
  </div>
</div>
{% endif %}
